<?xml version="1.0"?>
<construction>
  <sample>
    <path>
      <dir>non_prepared_query</dir>
      <dir>no_right_verification</dir>
    </path>
    <comment>construction : no right verification</comment>
    <code>$query = "SELECT * FROM COURSE where id=' $checked_data '";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
//flaw
$res = mysql_query($query);
mysql_close($conn);</code>
    <safety safe = "0"/>
    <constarint />
    <relevancy>1</relevancy>
  </sample>

  <sample>
    <path>
      <dir>non_prepared_query</dir>
      <dir>right_verification</dir>
    </path>
    <comment>construction : right verification</comment>
    <code>$query = "SELECT * FROM COURSE, USER WHERE courseID='$checked_data'";
$query .= "AND course.allowed=$_SESSION[userid]";$query = "SELECT * FROM COURSE where id=' $checked_data '";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
//flaw
$res = mysql_query($query);
mysql_close($conn);</code>
    <safety safe = "1"/>
    <constraint />
    <relevancy>1</relevancy>
  </sample>

  <sample>
    <path>
      <dir>prepared_query</dir>
      <dir>no_right_verification</dir>
    </path>
    <comment>construction : prepared query and no right verification</comment>
    <code>$query = "SELECT * FROM COURSE WHERE id=?";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
//flaw
$stmt->bind_param("i", $checked_data)
$stmt->execute()
mysql_close($conn);</code>
    <safety safe = "0"/>
    <constraint />
    <relevancy>1</relevancy>
  </sample>

  <sample>
    <path>
      <dir>prepared_query</dir>
      <dir>right_verification</dir>
    </path>
    <comment>construction : prepared query and right verification</comment>
    <code>$query = "SELECT * FROM COURSE, USER WHERE courseID=?";
$query .= "AND course.allowed=$_SESSION[userid]";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
//flaw
$stmt->bind_param("i", $checked_data)
$stmt->execute()
mysql_close($conn);</code>
    <safety safe = "1"/>
    <constraint />
    <relevancy>1</relevancy>
  </sample>
</construction>
